{
    "name": {{cluster.name}},
    "description": {{cluster.description}},
    "vxnet": {{cluster.vxnet}},
    "display_tabs": {
        "dashboards": {
            "cmd": "/etc/init.d/grafana-service dashboards",
            "timeout": 10,
            "description": "Grafana's dashboards template. Download by wget ftp://ip/file"
        },
        "job_list": {
            "cmd": "/etc/init.d/grafana-service displayjobs",
            "timeout": 10,
            "description": "Display the Prometheus's job list."
        }
    },
    "nodes": [
        {
            "role": "grafana_node",
            "container": {
                "type": "lxc",
                "zone": "gd2a",
                "image": "img-ejwiduab"
            },
            "count": {{cluster.grafana_node.count}},
            "instance_class": {{cluster.grafana_node.instance_class}},
            "cpu": {{cluster.grafana_node.cpu}},
            "memory": {{cluster.grafana_node.memory}},
            "volume": {
                "size": {{cluster.grafana_node.volume_size}},
                "mount_point": "/data",
                "mount_options": "defaults,noatime",
                "filesystem": "ext4"
            },
            "vertical_scaling_policy": "sequential",
            "services": {
                "start": {
                    "cmd": "/etc/init.d/grafana-service start"
                },
                "restart": {
                   "cmd": "/etc/init.d/grafana-service restart"
                },
                "stop": {
                    "cmd": "/etc/init.d/grafana-service stop"
                },
                "modify_user":
                {
                    "type": "custom",
                    "cmd": "/etc/init.d/grafana-service modifyuser",
                    "timeout": 60,
                    "service_params": {
                        "oldpasswd": {{service_params.oldpasswd}},
                        "newpasswd": {{service_params.newpasswd}},
                        "confirmnew": {{service_params.confirmnew}}
                    }
                },
                "reset_admin":{
                    "type": "custom",
                    "cmd": "/etc/init.d/grafana-service reset",
                    "timeout": 60
                },
                "add_job":{
                    "type": "custom",
                    "cmd": "/etc/init.d/grafana-service addjob",
                    "timeout": 60,
                    "service_params": {
                        "job_name": {{service_params.job_name}},
                        "ip":{{service_params.ip}},
                        "port":{{service_params.port}}
                    }
                },
                "del_job":{
                    "type": "custom",
                    "cmd": "/etc/init.d/grafana-service deljob",
                    "timeout": 60,
                    "service_params": {
                        "job_name": {{service_params.job_name}}
                    }
                }
            },
            "health_check": {
                "enable": true,
                "interval_sec": 60,
                "timeout_sec": 30,
                "action_timeout_sec": 30,
                "healthy_threshold": 2,
                "unhealthy_threshold": 2,
                "check_cmd": "/etc/init.d/grafana-service healthcheck",
                "action_cmd": "/etc/init.d/grafana-service healthaction"
            },
            "advanced_actions": ["associate_eip"]
        }    
    ]
}
